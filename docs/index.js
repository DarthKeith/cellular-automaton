(()=>{var G={compose:function(r){return function(n){return function(t){return r(n(t))}}}};var E=function(r){return r.identity},Z={identity:function(r){return r},Semigroupoid0:function(){return G}};var H=function(r){return function(n){return r}};var g=function(r){return r.map};var Wr=E(Z);var _=function(r){return r.apply};var sr=function(r){var n=_(r),t=g(r.Functor0());return function(e){return function(o){return n(t(H(Wr))(e))(o)}}};function v(r){return Array(r).fill(0)}function x(r){return Math.floor(Math.random()*r)}function dr(r){return v(r).map(()=>Xr(r,r,r))}function yr(r){return v(r).map(Yr)}function Kr(r,n){return v(r).map(()=>x(n))}function Xr(r,n,t){return v(r).map(()=>Kr(n,t))}function Yr(){return[x(256),x(256),x(256)]}function W(r){return r===T?!1:(T=r,!0)}function R(){for(let r=0;r<c.length;r++)c[r]=x(T)}function gr(r){c=v(r),F=v(r),R()}function S(){_r=dr(T)}function K(){let r=c.slice();return jr(),r}var T,_r,c,F;function jr(){let r=c.length-1;for(let n=0;n<=r;n++){let t=n===0?r:n-1,e=n===r?0:n+1;F[n]=_r[c[t]][c[n]][c[e]]}[c,F]=[F,c]}var X=16.666666666666668,xr=200,Rr=5,q=4,Y=5,j=2;var i={numStatesButtons:document.getElementById("num-states-btns"),ruleButton:document.getElementById("rule-btn"),resetButton:document.getElementById("reset-btn"),cellSizeButtons:document.getElementById("cell-size-btns"),colorButton:document.getElementById("color-btn"),pauseButton:document.getElementById("pause-btn")};function Sr(){P(u,window.innerWidth,window.innerHeight);let r=Math.floor(u.width/p),n=1+Math.ceil(u.height/p);return P(f,r,n),P(hr,r,1),rr=Jr.createImageData(r,1),C=rr.data,nn(C),Ar(U),I=r*p,$=n*p,tr=Math.floor((u.width-I)/2),s=-j,r}function Dr(){if(u.width!==window.innerWidth)return!1;P(u,window.innerWidth,window.innerHeight);let r=1+Math.ceil(u.height/p),n=D.getImageData(0,0,f.width,f.height);return P(f,f.width,r),D.putImageData(n,0,0),Ar(U),$=r*p,U.drawImage(f,tr,s,I,$),!0}function Cr(){un(),an()}function nr(r){if(s+=j,s>0){let n=Math.ceil(s/p);en(n,r),s-=n*p}U.drawImage(f,tr,s,I,$)}function B(){br=yr(Rr)}function Pr(r){return r===p?!1:(p=r,!0)}var J=document.getElementById("settings"),u=document.getElementById("canvas"),f=document.createElement("canvas"),hr=document.createElement("canvas"),U=u.getContext("2d",{alpha:!1}),D=f.getContext("2d",{alpha:!1}),Jr=hr.getContext("2d",{alpha:!1}),rr,C,br,p=Y,I,$,tr,s;function rn(){J.style.display==="none"?(J.style.display="grid",u.style.cursor="default"):(J.style.display="none",u.style.cursor="none")}function P(r,n,t){r.width=n,r.height=t}function nn(r){for(let n=3;n<r.length;n+=4)r[n]=255}function Ar(r){r.imageSmoothingEnabled=!1,r.webkitImageSmoothingEnabled=!1,r.msimageSmoothingEnabled=!1}function tn(r){let n=0;for(let t of r)[C[n],C[n+1],C[n+2]]=br[t],n+=4}function en(r,n){let t=D.getImageData(0,0,f.width,f.height);for(D.putImageData(t,0,r);r>0;)r-=1,tn(n()),D.putImageData(rr,0,r)}var Er=r=>r.classList.add("selected"),on=r=>r.classList.remove("selected");function un(){u.addEventListener("click",rn);let r=e=>e.target.blur(),n=e=>e.addEventListener("click",r);document.querySelectorAll("button").forEach(n);function t(e){function o(l){if(l.target.tagName==="BUTTON"){for(let O of e.children)on(O);Er(l.target)}}e.addEventListener("click",o)}t(i.numStatesButtons),t(i.cellSizeButtons)}function an(){function r(n,t){for(let e of n.children)if(parseInt(e.getAttribute("value"))===t){Er(e);return}}r(i.numStatesButtons,q),r(i.cellSizeButtons,Y)}function or(){W(q),S(),B(),Cr(),ln(),ir()}function ur(){let r=document.timeline.currentTime;function n(t){t-r>=X&&(er||nr(K),r+=X),requestAnimationFrame(n)}requestAnimationFrame(n)}var er=!1;function ir(){let r=Sr();gr(r),nr(K)}function cn(r){Pr(r)&&ir()}function fn(r){W(r)&&(S(),R())}function wr(){er=!er}function pn(){let r=0;function n(){Dr()||ir()}function t(){clearTimeout(r),r=setTimeout(n,xr)}return t}function mn(r){r.key===" "?wr():r.key==="Backspace"?R():r.key==="c"?B():r.key==="Enter"&&S()}function ln(){window.addEventListener("resize",pn()),window.addEventListener("keyup",mn),i.pauseButton.addEventListener("click",wr),i.resetButton.addEventListener("click",R),i.colorButton.addEventListener("click",B),i.ruleButton.addEventListener("click",S);for(let r of i.cellSizeButtons.children){let n=parseInt(r.value);r.addEventListener("click",()=>cn(n))}for(let r of i.numStatesButtons.children){let n=parseInt(r.value);r.addEventListener("click",()=>fn(n))}}var Fr=function(r){return function(){return r}},Tr=function(r){return function(n){return function(){return n(r())()}}};var h=function(r){return r.pure};var z=function(r){var n=_(r.Apply0()),t=h(r);return function(e){return function(o){return n(t(e))(o)}}};var ar=function(r){return r.bind};var $r=function(r){var n=ar(r.Bind1()),t=h(r.Applicative0());return function(e){return function(o){return n(e)(function(l){return n(o)(function(O){return t(l(O))})})}}};var Mr=function(r,n,t){var e=0,o;return function(l){if(e===2)return o;if(e===1)throw new ReferenceError(r+" was needed before it finished initializing (module "+n+", line "+l+")",n,l);return e=1,o=t(),e=2,o}},$n={Applicative0:function(){return kr},Bind1:function(){return Bn}},Bn={bind:Tr,Apply0:function(){return fr(0)}},kr={pure:Fr,Apply0:function(){return fr(0)}},zn=Mr("functorEffect","Effect",function(){return{map:z(kr)}}),fr=Mr("applyEffect","Effect",function(){return{apply:$r($n),Functor0:function(){return zn(0)}}});var Or=fr(23);var Gr=sr(Or)(or)(ur);Gr();})();
